<div class="card custom-summery-table">
  <div class="card-header pb-0">
    <div class="header-top">
      <h5>Project Summery</h5>
      <div class="dropdown icon-dropdown" (clickOutside)="clickOutside()">
        <button class="btn dropdown-toggle" type="button" (click)="open()">
          <i class="icon-more-alt"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-end" [class.show]="isOpen">
          <a class="dropdown-item" href="javascript:void(0)">Weekly</a>
          <a class="dropdown-item" href="javascript:void(0)">Monthly</a>
          <a class="dropdown-item" href="javascript:void(0)">Yearly</a>
        </div>
      </div>
    </div>
  </div>
  <div class="card-body pt-0 project-summary">
    <div class="table-responsive custom-scrollbar">
      <div class="dataTables_wrapper no-footer">
        <div class="dataTables_length"></div>
        <div class="dataTables_filter">
          <div class="mb-3 row">
            <label
              for="table-complete-search"
              class="col-xs-3 col-sm-auto col-form-label"
              >Search:</label
            >
            <div class="col-xs-3 col-sm-auto">
              <input
                id="table-complete-search"
                type="text"
                class="form-control"
                name="searchTerm"
                [(ngModel)]="service.searchTerm"
                autocomplete="off"
              />
            </div>
            @if(service.loading$ | async){
            <span class="col col-form-label">Loading...</span>
            }
          </div>
        </div>
        <table
          class="table display dataTable no-footer"
          id="project-summary"
          style="width: 100%"
        >
          <thead>
            <tr>
              <th>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="" />
                  <label class="form-check-label"></label>
                </div>
              </th>
              <th sortable="name" (sort)="onSort($event)">
                <span>Project name</span>
              </th>
              <th sortable="type" (sort)="onSort($event)">
                <span>Project Type</span>
              </th>
              <th><span>Teams</span></th>
              <th sortable="date" (sort)="onSort($event)">
                <span>Start Date</span>
              </th>
              <th sortable="location" (sort)="onSort($event)">
                <span>Clients Location</span>
              </th>
              <th sortable="status"><span>Status</span></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            @for(data of tableData$ | async; track data; let i = $index){
            <tr>
              <td>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    [(ngModel)]="data.value"
                  />
                  <label class="form-check-label"></label>
                </div>
              </td>
              <td><span>{{ data.name}}</span></td>
              <td>{{ data.type }}</td>
              <td>
                <div class="user-details customers">
                  <ul>
                    @for( item of data.data; track item){
                    <li class="d-inline-block">
                      <img src="{{ item.img}}" alt="user" />
                    </li>
                    }
                  </ul>
                </div>
              </td>
              <td>{{ data.date }}</td>
              <td>{{ data.location}}</td>
              <td class="font-{{ data.class }}">{{ data.status }}</td>
              <td>
                <div
                  class="dropdown icon-dropdown"
                  (clickOutside)="data.isActive = false"
                >
                  <button
                    class="btn dropdown-toggle"
                    type="button"
                    (click)="show(data.id)"
                  >
                    <i class="icon-more-alt"></i>
                  </button>
                  <div
                    class="dropdown-menu dropdown-menu-end"
                    [class.show]="data.isActive"
                  >
                    <a class="dropdown-item" href="javascript:void(0)"
                      >Weekly</a
                    >
                    <a class="dropdown-item" href="javascript:void(0)"
                      >Monthly</a
                    >
                    <a class="dropdown-item" href="javascript:void(0)"
                      >Yearly</a
                    >
                  </div>
                </div>
              </td>
            </tr>
            } @empty{
            <tr class="odd">
              <td
                colspan="12"
                class="dataTables_empty"
                style="text-align: center; font-size: 15px"
              >
                No records found
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
      <div
        class="dataTables_paginate paging_simple_numbers d-flex justify-content-between"
      >
        <span class="mt-4"
          >Showing {{ getStartingIndex() }} to {{ getEndingIndex() }} of {{
          filteredData.length }} entries</span
        >
        <span>
          <ngb-pagination
            class="paginate_button ms-3"
            [collectionSize]="( total$ | async)!"
            [(page)]="service.page"
            [pageSize]="service.pageSize"
          />
        </span>
      </div>
    </div>
  </div>
</div>
